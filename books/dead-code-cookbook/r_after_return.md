---
title: "🧪return後のコード"
---

|||
|:--|:--|
|🔖|`return` `中断を利用するパターン`|
|👼|`return削除` `ネスト修正`|
|🧟|`goto文のラベル` `ホイスティング`|

``` ruby:after_return.rb:./projects/ruby/after_return.rb
return
puts 'Am I dead?'
```

# 🧪デッドコードレシピ🧪

`🧪return後のコード` は、デッドコードレシピとして最も代表的なパターンだ。プログラミング言語やツールで最も検知されるパターンと言っても過言ではないだろう。

`return` は、多くのプログラミング言語で、処理を呼出元に戻すために使われる。関数において使われることが多いが、スクリプト言語ではトップレベルのスクリプト環境でも実行できるものもある。例えば、pythonはモジュールで `return` を使用できないため、トップレベルのスクリプト環境では使えないが、rubyは使える。

`中断を利用するパターン` である。`return` 後に書かれているコードは、基本的にはデッドコードとなる。

 - デバッグのために残した `return` が残ってしまった。 -> `👼return削除`
 - `if` 文等の条件内を想定していたが、ネストを誤った。 -> `👼ネスト修正`
 - マージ等で `return` 文が重複した。 -> `👼return削除`
 - `return` 追加による修正後、不要なコードを消さなかった。 -> `🛐`
 - goto文のラベルを記載している。 -> `🧟goto文のラベル`
 - `🛐` -> `🧟ホイスティング` に注意


# 👼レイズ👼

## `👼return削除`

`return` を削除することで、後続の処理を復活させる。

``` diff:after_return.rb
-return
 puts 'Am I dead?'
```

## `👼ネスト修正`

構文木において、 `return` を前要素ではなくなるように、インデントや中括弧を追加することで、後続の処理を復活させる。 

``` diff:after_return_with_if.py
 import sys
 
 
 def main():
     if len(sys.argv) > 1:
         print("Cannot enter arguments.")
-    return
+        return
     print("Am I dead?")
 
 
 main()
```



# 🧟ゾンビ化🧟

## `🧟goto文のラベル`

goto文 をサポートしている言語で、goto文のラベルが中断される処理の後に記載されている場合、ゾンビ化可能である。



## `🧟ホイスティング`

中断される処理の後に記載されている場合でも、ホイスティング(巻き上げ)される場合はデッドコードではなく、ゾンビ化されている。



# 言語毎の詳細

## 検出可否

||||
|:--|:--|:--|
|Python|-|検知不可|
||flake8|検知不可|
|Ruby|-|検知不可|
||-w(turn warnings)|検知可能|
||rubocop|検知可能|

## サンプルコード

